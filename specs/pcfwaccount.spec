# Model
model:
  rest_name: pcfwaccount
  resource_name: pcfwaccounts
  entity_name: PCFWAccount
  package: ngfw
  group: onboarding
  description: Represents Prisma Cloud Firewall Account.
  get:
    description: Retrieve the status of the account.
  update:
    description: retries updating the role ARNs with NGFW.
  delete:
    description: offboard the account.
  extends:
  - '@identifiable-stored'
  - '@namespaced'
  - '@base'
  - '@zoned'
  - '@timeable'

# Attributes
attributes:
  v1:
  - name: AWSAccountID
    description: AWS Account ID.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: 640574671726
    validations:
    - $awsaccount

  - name: LogQueryExternalID
    description: External ID used in logQueryRole.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: NGFWCFTHash
    description: NGFW cloud formation template hash.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: NGFWExternalID
    description: NGFW external ID.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: NGFWOnboardingStatus
    description: NGFW onboarding status.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: NGFWServiceAccountID
    description: NGFW AWS service account ID.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: NGFWTenantID
    description: NGFW tenant ID.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: PCTenantIssuer
    description: Issuer for Prisma Cloud tenant (identifies the PC stack for IAM role
      usage).
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: athenaWorkgroup
    description: Athena workgroup to execute queries in.
    type: string
    exposed: true
    stored: true
    required: true
    default_value: logs_workgroup
    max_length: 127
    validations:
    - $athenaworkgroup

  - name: decryptionRoleARN
    description: AWS rulestack decryption role ARN.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: arn:aws:iam::640574671726:role/DecryptionRole
    validations:
    - $rolearn

  - name: endpointRoleARN
    description: AWS endpoint role ARN.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: arn:aws:iam::640574671726:role/CustomerManagedEndpoint
    validations:
    - $rolearn

  - name: logDestination
    description: |-
      The log destination for logging. The value will be converted to lower case and
      have the aws account id and logging region appended to it (ie.
      logs-1234-us-east-2) when used to create an S3 bucket for logging.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: logs
    max_length: 30
    validations:
    - $logdestination

  - name: logDestinationType
    description: Destination type for log output.
    type: enum
    exposed: true
    stored: true
    required: true
    allowed_choices:
    - Prisma
    - S3
    - Cloudwatch
    - KinesisFirehose
    default_value: Prisma

  - name: logPushRoleARN
    description: ARN of AWS role that allows the NGFW to push logs.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: arn:aws:iam::1234567890:role/NGFWLogPushRole
    validations:
    - $rolearn

  - name: logQueryRoleARN
    description: ARN of AWS role that allows the PCFW to query logs.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: arn:aws:iam::1234567890:role/PCFWLogQueryRole
    validations:
    - $rolearn

  - name: logRegion
    description: The AWS region where logging data lives.
    type: string
    exposed: true
    stored: true
    required: true
    example_value: us-east-1

  - name: logResourcePrefix
    description: Prefix to use for logging resources.
    type: string
    exposed: true
    stored: true
    required: true
    default_value: pcfw
    max_length: 8
    validations:
    - $logresourceprefix

  - name: primaryAccount
    description: indicates the primary AWS account.
    type: boolean
    exposed: true
    stored: true
    read_only: true
    autogenerated: true

  - name: status
    description: status of account.
    type: enum
    exposed: true
    stored: true
    read_only: true
    allowed_choices:
    - Creating
    - Pending
    - Success
    - Failed
    - Deleting
    autogenerated: true

  - name: statusReason
    description: status failure reason.
    type: string
    exposed: true
    stored: true
    read_only: true
    autogenerated: true
